<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The multiple outside transmissions extension to the model â€¢ InfectionTrees</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="The multiple outside transmissions extension to the model">
<meta property="og:description" content="InfectionTrees">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">InfectionTrees</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/getting-started.html">Getting started with `InfectionTrees`</a>
    </li>
    <li>
      <a href="../../articles/not-built-vignettes/base-binary-simulations.html">Binary covariate model simulations</a>
    </li>
    <li>
      <a href="../../articles/not-built-vignettes/base-general-simulations.html">Multiple covariate model simulations</a>
    </li>
    <li>
      <a href="../../articles/not-built-vignettes/model-overview.html">The model</a>
    </li>
    <li>
      <a href="../../articles/not-built-vignettes/multiple-outside-binary-simulations.html">Binary covariate multiple outside transmissions model simulations</a>
    </li>
    <li>
      <a href="../../articles/not-built-vignettes/multiple-outside-transmissions-model.html">The multiple outside transmissions extension to the model</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/skgallagher/InfectionTrees/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="multiple-outside-transmissions-model_files/header-attrs-2.3/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>The multiple outside transmissions extension to the model</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/skgallagher/InfectionTrees/blob/master/vignettes/not-built-vignettes/multiple-outside-transmissions-model.Rmd"><code>vignettes/not-built-vignettes/multiple-outside-transmissions-model.Rmd</code></a></small>
      <div class="hidden name"><code>multiple-outside-transmissions-model.Rmd</code></div>

    </div>

    
    
<div id="goals-of-this-vignette" class="section level2">
<h2 class="hasAnchor">
<a href="#goals-of-this-vignette" class="anchor"></a>Goals of this vignette</h2>
<ol style="list-style-type: decimal">
<li><p>Briefly recap the base model and its limitation of forcing all clusters be directly connected via root node.</p></li>
<li><p>Describe the Multiple Outside Transmissions (MOT) model which addresses this problem.</p></li>
<li><p>Describe pros and cons of the MOT model.</p></li>
</ol>
</div>
<div id="recall-the-base-model" class="section level2">
<h2 class="hasAnchor">
<a href="#recall-the-base-model" class="anchor"></a>Recall the base model</h2>
<p>The base model is described in detail <a href="model-overview.Rmd">here</a>. The basic idea is that we sample transmission trees from the set of permissible transmission trees, <span class="math inline">\(\mathcal{T}_n\)</span> and use these samples to estimate the average likelihood over a cluster.</p>
<p>However, <span class="math inline">\(\mathcal{T}_n\)</span> is a set that <strong>forces</strong> all individuals within a cluster to be connected via transmission paths directly to a primary root node, the primary infector of the cluster. In other words, we assume that all transmissions, besides a single infection from the outside to the primary infector, within the cluster are observed. Effectively, this means we assume, possibly dubiously so, that there is no underreporting of cases.</p>
<p>For example, consider the below figure. The left shows the actual transmission tree, where individual <span class="math inline">\(A\)</span> is the true root node. Individuals <span class="math inline">\(A\)</span> and <span class="math inline">\(E\)</span> (blue squares) are both unobserved and so are the transmissions into and out of those nodes.</p>
<p>Thus the best reconstruction of the original tree given only nodes <span class="math inline">\(B, C, D, F, G\)</span>, and <span class="math inline">\(H\)</span> is shown in the middle figure, which is made of four disconnected sub-trees, three singlestons (<span class="math inline">\(T_A\)</span>, <span class="math inline">\(T_D\)</span>, and <span class="math inline">\(T_G\)</span>) along with the subtree <span class="math inline">\(T_{CFH} = \{ C \to F \to H\}\)</span>. Unfortunately the forest <span class="math inline">\(F = (T_B, T_{CFH}, T_{D}, T_{G} )\)</span> is not a permissible transmisison tree in <span class="math inline">\(\mathcal{T}_6\)</span>.</p>
<p>Our questions are 1) how can we (minimally) expand the set of permissible transmission trees to include forests like <span class="math inline">\(F\)</span>? and 2) can we re-use the same sampling methods for sampling <span class="math inline">\(T \in \mathcal{T}_6\)</span>.</p>
<p><img src="images/mot.png"></p>
</div>
<div id="our-solution-the-multiple-outside-transmission-model" class="section level2">
<h2 class="hasAnchor">
<a href="#our-solution-the-multiple-outside-transmission-model" class="anchor"></a>Our solution: the multiple outside transmission model</h2>
<p>We approach the problem of including multiple sub-trees through a model we call the multiple outside transmission model (MOT). The MOT allows for underreporting of cases through a reconstruction of the observable nodes and transmissions and connecting separate sub-trees via a latent root node which we call the outsider. This reconstruction is pictured in the right-most figure pictured above.</p>
<p>The idea is a transformation of the original transmission tree into multiple sub-trees of the observable nodes and the latent otusider. For example, in the above figure, individual <span class="math inline">\(E\)</span> is not observed and so our outsider model reconstruction considers individual <span class="math inline">\(G\)</span> to be a singleton, separate from the other nodes. The consequence is that for <span class="math inline">\(n\)</span> observed indiviudals in a cluster we permit the sampling of all transmission forests <span class="math inline">\(F = (O, T_1, \dots, T_W)\)</span> where <span class="math inline">\(O\)</span> represents the latent root quantity that directly infects <span class="math inline">\(W\)</span> <span class="math inline">\(\in \{1, \dots, n\}\)</span> individuals, who in turn are the root nodes of the transmission trees <span class="math inline">\(T_1, \dots, T_W\)</span> such that the <span class="math inline">\(n\)</span> individuals appear in exactly one of the sub-trees. We call this space of permissible forests <span class="math inline">\(\mathcal{F}_n\)</span>.</p>
<p>The likelihood for a given forest <span class="math inline">\(F\)</span> with <span class="math inline">\(n\)</span> observed nodes is <span class="math display">\[
L(F) = (1-p_O)p_O^{N_O-1}\prod_{i=1}^n (1-p_i)p_i^{N_i},
\]</span> where <span class="math inline">\(p_O\)</span> is the probability of infection of the imputed outsider in the forest. The likelihood of the number of outsider successful infections is <span class="math inline">\(N_o -1\)</span> and not <span class="math inline">\(N_O\)</span> because we condition on the fact that the outsider must always have at least one positive transmission if we are to observe a cluster at all.</p>
<p>The only change to the total likelihood for a cluster <span class="math inline">\(C\)</span> of size <span class="math inline">\(n\)</span> is then <span class="math display">\[
\mathcal{L}_O(C) = \sum_{F \in \mathcal{F}_n}L(F)
\]</span> and so we must sample from <span class="math inline">\(\mathcal{F}_n\)</span> instead of <span class="math inline">\(\mathcal{T}_n\)</span>. However, note the reconstruction in the right-most figure pictured above is exactly a transmission tree in <span class="math inline">\(\mathcal{T}_{n+1}\)</span> where we separately sample the covariates of the root node and randomly draw the remaining labels for the remaining <span class="math inline">\(n\)</span> individuals in the later generations. The upshot of this is that we can use the same sampling method to sample <span class="math inline">\(T\in \mathcal{T}_n\)</span> with only two minor modifications: We sample trees of size <span class="math inline">\(n+1\)</span> instead of <span class="math inline">\(n\)</span> and we permute the labels of the <span class="math inline">\(n\)</span> individuals in the tree to the nodes in generation <span class="math inline">\(g \ge 2\)</span> and randomly draw labels for outsider/root node.</p>
</div>
<div id="pros-and-cons-of-the-mot" class="section level2">
<h2 class="hasAnchor">
<a href="#pros-and-cons-of-the-mot" class="anchor"></a>Pros and cons of the MOT</h2>
<p>Pros:</p>
<ol style="list-style-type: decimal">
<li><p>Allows for underreporting</p></li>
<li><p>Uses same sampling methodology</p></li>
<li><p>Allows for flexibility in imputing the outsider covariates</p></li>
</ol>
<p>Cons:</p>
<ol style="list-style-type: decimal">
<li><p>More uncertainty due to unknown outsider</p></li>
<li><p>Generally favors transmission trees with fewer generations</p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Shannon Gallagher.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
