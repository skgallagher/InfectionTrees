<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting started with `InfectionTrees` â€¢ InfectionTrees</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting started with `InfectionTrees`">
<meta property="og:description" content="InfectionTrees">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">InfectionTrees</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/getting-started.html">Getting started with `InfectionTrees`</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/index.html">More...</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/skgallagher/InfectionTrees/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="getting-started_files/header-attrs-2.9/header-attrs.js"></script><script src="getting-started_files/kePrint-0.0.1/kePrint.js"></script><link href="getting-started_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting started with <code>InfectionTrees</code>
</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/skgallagher/InfectionTrees/blob/master/vignettes/getting-started.Rmd"><code>vignettes/getting-started.Rmd</code></a></small>
      <div class="hidden name"><code>getting-started.Rmd</code></div>

    </div>

    
    
<p><code>InfectionTrees</code> is a software package used to sample and analyze branching processes that model the spread of infectious diseases.</p>
<div id="downloading-the-package" class="section level2">
<h2 class="hasAnchor">
<a href="#downloading-the-package" class="anchor"></a>Downloading the package</h2>
<p>Currently, <code>InfectionTrees</code> is available at <a href="https://github.com/skgallagher/InfectionTrees">https://github.com/skgallagher/InfectionTrees</a>, and can be installed in <code>R</code> via the following command,</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"skgallagher/InfectionTrees"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/skgallagher/InfectionTrees">InfectionTrees</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/">knitr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com">data.table</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="about" class="section level2">
<h2 class="hasAnchor">
<a href="#about" class="anchor"></a>About</h2>
<p>Below is a true quick start to simulate data, sample trees based on that data, and finally compute the log likelihood.</p>
<p>The other vignettes cover:</p>
<p><strong>The Model</strong></p>
<ol style="list-style-type: decimal">
<li><a href="not-built-vignettes/model-overview.html">General overview</a></li>
<li><a href="not-built-vignettes/multiple-outside-transmissions-model.html">Accounting for under-reporting (Multiple outside transmissions model)</a></li>
<li><a href="not-built-vignettes/sampling-mc-trees.html">Sampling from <span class="math inline">\(\mathcal{T}_C\)</span></a></li>
<li><a href="not-built-vignettes/sampling-enough-mc-trees.html">Sampling enough MC trees</a></li>
</ol>
<p><strong>Simulations</strong></p>
<ol style="list-style-type: decimal">
<li><a href="not-built-vignettes/base-binary-simulations.html">Simulations for the base model: binary covariates</a></li>
<li><a href="not-built-vignettes/base-general-simulations.html">Simulations for the base model: general covariates</a></li>
<li><a href="not-built-vignettes/multiple-outside-binary-simulations.html">Simulations for the multiple outside transmission model</a></li>
<li><a href="not-built-vignettes/simulations-enough-mc-trees.html">Simulations to assess whether we sampled enough MC trees</a></li>
</ol>
<p><strong>Tuberculosis in Maryland</strong></p>
<ol style="list-style-type: decimal">
<li><a href="not-built-vignettes/tb-eda.html">The data</a></li>
<li><a href="not-built-vignettes/tb-data-base.html">Running our models on the data</a></li>
<li><a href="not-built-vignettes/tb-data-vis.html">Visualizing the results</a></li>
</ol>
</div>
<div id="simulating-branching-processes" class="section level2">
<h2 class="hasAnchor">
<a href="#simulating-branching-processes" class="anchor"></a>Simulating branching processes</h2>
<p>We can simulate from a branching process to form a data set of transmission trees or clusters (if we remove infector information from the transmission trees). We simulate <span class="math inline">\(K\)</span> branching processes where the primary infector in each tree is the root of each transmission tree and the probability of infection of another individual is where <span class="math inline">\(\bf{X}\)</span> is a covariate matrix and <span class="math inline">\(\beta\)</span> is a vector of coefficients, <span class="math display">\[
p_i = logit^{-1} (\bf{X}_i\bf{\beta}).
\]</span> Then the number of <em>new</em> infectious individuals infected by individual <span class="math inline">\(i\)</span> is <span class="math display">\[
N_i \sim geometric(p_i)
\]</span></p>
<p>It is possible to produce transmission trees that do not naturally terminate, so a maximal number of infections is used as an argument. The output is a data frame with <span class="math inline">\(M\)</span> transmission trees which contains the cluster ID, the person ID within a cluster, the generation of the person (i.e.Â the length of the path from the primary infector to the person + 1), the infector ID (i.e.Â who infected this person), the number of infections caused directly by this person if any, the total cluster size, the covariates, and an indicator telling us whether the cluster was artificially terminated or not (i.e.Â <code>censored = TRUE</code>).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2020</span><span class="op">)</span>
<span class="co">## Generate possible covariates </span>
<span class="va">sample_covariates_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>

<span class="va">beta0</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2</span>
<span class="va">beta1</span> <span class="op">&lt;-</span> <span class="fl">1.5</span>
<span class="va">M</span> <span class="op">&lt;-</span> <span class="fl">100</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_bp.html">simulate_bp</a></span><span class="op">(</span>K <span class="op">=</span> <span class="va">M</span>,
                                  inf_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">beta0</span>, <span class="va">beta1</span><span class="op">)</span>,
                                  sample_covariates_df <span class="op">=</span> <span class="va">sample_covariates_df</span>,
                                  covariate_names <span class="op">=</span> <span class="st">"x"</span>,
                                  max_size <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>

<span class="va">data</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">.</span>, <span class="fl">10</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table table table-striped table-hover table-condensed">
<thead><tr>
<th style="text-align:right;">
cluster_id
</th>
<th style="text-align:left;">
person_id
</th>
<th style="text-align:right;">
gen
</th>
<th style="text-align:left;">
inf_id
</th>
<th style="text-align:right;">
n_inf
</th>
<th style="text-align:right;">
cluster_size
</th>
<th style="text-align:right;">
x
</th>
<th style="text-align:left;">
censored
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
C1-G1-N1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
C2-G1-N1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
C3-G1-N1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
C4-G1-N1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
C5-G1-N1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
C6-G1-N1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
C7-G1-N1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
C7-G2-N1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
C7-G1-N1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
C8-G1-N1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
C9-G1-N1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
</tbody>
</table>
</div>
<div id="estimate-the-maximum-likelihood" class="section level2">
<h2 class="hasAnchor">
<a href="#estimate-the-maximum-likelihood" class="anchor"></a>Estimate the maximum likelihood</h2>
<p>Although our data above are true transmission trees (i.e.Â we can trace a direct path of infections), generally the infector ID is unknown and hence the data is a group of individuals where the transmission tree is not known.</p>
<p>We estimate the parameters <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> by summing over all possible transmission trees for each cluster, which includes the number of individuals in each cluster and their covariates.</p>
<p>The likelihood for a given transmission tree <span class="math inline">\(T\)</span> with <span class="math inline">\(n\)</span> individuals is</p>
<p><span class="math display">\[
L(\beta; T) = \prod_{i=1}^n (1-p_i)p_i^{N_i}
\]</span> and the total likelihood of a single cluster <span class="math inline">\(C\)</span> over all trees of size <span class="math inline">\(|C|=n\)</span> is <span class="math display">\[
\mathcal{L}( \beta; C) = \sum_{T \in \mathcal{T}_C} L(\beta;T).
\]</span></p>
<p>We instead maximize the <strong>approximate</strong> likelihood, which is obtained from sampling transmission trees from <span class="math inline">\(\mathcal{T}_n\)</span>. That is, we approximate <span class="math inline">\(\frac{\mathcal{L}(C, \beta)}{|\mathcal{T}_C|}\)</span> averaging the likelihood from Monte Carlo sampled trees <span class="math inline">\(T_1, \dots, T_K\)</span>,</p>
<p><span class="math display">\[
\hat{\mathcal{L}}_K(\beta; C) = \frac{1}{K} \sum_{i=1}^K L(\beta, T_i).
\]</span></p>
<p>The estimates for the parameters are then found by maximizing the likelihood over the approximate likelihood over all clusters <span class="math inline">\(C_1, \dots, C_M\)</span> <span class="math display">\[
\left (\hat{\beta} \right)^{(MC)} = \arg \max_{\beta} \prod_{m=1}^M \hat{\mathcal{L}}_K(\beta; C_m).
\]</span></p>
<div id="how-to-get-sampled-transmission-trees" class="section level3">
<h3 class="hasAnchor">
<a href="#how-to-get-sampled-transmission-trees" class="anchor"></a>How to get sampled transmission trees</h3>
<p>If we want to sample <span class="math inline">\(B\)</span> transmission trees for each cluster in our data, we use the function <code>sample_mc_trees</code>. Here, <code>B</code> is the number of MC samples. Typically this number is <span class="math inline">\(\ge5000\)</span>, but we use 10 below for demonstrative purposes.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mc_trees</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sample_mc_trees.html">sample_mc_trees</a></span><span class="op">(</span>observed_data <span class="op">=</span> <span class="va">data</span>, B <span class="op">=</span> <span class="fl">10</span>,
                            covariate_names <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span>

<span class="va">mc_trees</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">.</span>, <span class="fl">4</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span> <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table table table-striped table-hover table-condensed">
<thead><tr>
<th style="text-align:right;">
cluster_size
</th>
<th style="text-align:right;">
gen
</th>
<th style="text-align:right;">
n_in_gen
</th>
<th style="text-align:left;">
id
</th>
<th style="text-align:right;">
n_inf
</th>
<th style="text-align:left;">
cluster_id
</th>
<th style="text-align:right;">
x
</th>
<th style="text-align:right;">
orig_id
</th>
<th style="text-align:left;">
inf_id
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
1-1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
n1-g1-1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
1-1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
n1-g1-2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
1-1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
n1-g1-3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
1-1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
n1-g1-4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
NA
</td>
</tr>
</tbody>
</table>
<p>The samples are linked to the original cluster by the variable <code>orig_id</code>.</p>
</div>
</div>
<div id="compute-the-log-likelihood" class="section level2">
<h2 class="hasAnchor">
<a href="#compute-the-log-likelihood" class="anchor"></a>Compute the log likelihood</h2>
<p>Once the MC trees are sampled, it is possible to compute the log likelihood using the function <code><a href="../reference/general_loglike.html">general_loglike()</a></code></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>loglike <span class="ot">&lt;-</span> <span class="fu">general_loglike</span>(<span class="at">inf_params =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">1</span>),</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">mc_trees =</span> mc_trees,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">return_neg =</span> <span class="cn">FALSE</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">cov_names =</span> <span class="st">"x"</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                           </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(loglike)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="sc">-</span><span class="fl">107.5961</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Shannon Gallagher, Dean Follmann.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
